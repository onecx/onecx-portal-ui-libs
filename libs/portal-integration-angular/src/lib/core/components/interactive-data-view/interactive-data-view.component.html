<div class="p-3 border-bottom-1 surface-border">
  <div class="flex flex-wrap justify-content-between align-items-center py-1 gap-2">
    <ocx-data-layout-selection
      [supportedViewLayouts]="supportedViewLayouts"
      [layout]="layout"
      (dataViewLayoutChange)="onDataViewLayoutChange($event)"
    ></ocx-data-layout-selection>

    <div *ngIf="layout !== 'table'" class="flex align-items-center gap-2">
      <ocx-data-list-grid-sorting
        [sortDirection]="sortDirection"
        [sortField]="sortField"
        [columns]="columns"
        [sortStates]="sortStates"
        (sortChange)="onSortChange($event)"
        (sortDirectionChange)="onSortDirectionChange($event)"
      ></ocx-data-list-grid-sorting>
    </div>

    <div *ngIf="layout === 'table'" class="flex flex-wrap justify-content-between align-items-center gap-2">
      <ocx-column-group-selection
        [selectedGroupKey]="selectedGroupKey"
        [columns]="columns"
        [defaultGroupKey]="defaultGroupKey"
        [customGroupKey]="customGroupKey"
        [placeholderKey]="groupSelectionNoGroupSelectedKey"
        (groupSelectionChanged)="onColumnGroupSelectionChange($event)"
      ></ocx-column-group-selection>

      <ocx-custom-group-column-selector
        [columns]="columns"
        [displayedColumns]="displayedColumns"
        (columnSelectionChanged)="onColumnSelectionChange($event)"
      ></ocx-custom-group-column-selector>
    </div>
  </div>
</div>
<div class="p-3">
  <ocx-data-view
    [columns]="displayedColumns"
    [sortStates]="sortStates"
    [sortField]="sortField"
    [filters]="filters"
    [data]="data"
    [sortDirection]="sortDirection"
    [titleLineId]="titleLineId || firstColumnId"
    [subtitleLineIds]="subtitleLineIds"
    [clientSideSorting]="true"
    [clientSideFiltering]="true"
    [pageSizes]="pageSizes"
    [pageSize]="pageSize"
    [emptyResultsMessage]="emptyResultsMessage"
    [layout]="layout"
    [name]="name"
    [deletePermission]="deletePermission"
    [editPermission]="editPermission"
    [viewPermission]="viewPermission"
    [additionalActions]="additionalActions"
    [listGridPaginator]="listGridPaginator"
    [tablePaginator]="tablePaginator"
    [selectedRows]="selectedRows"
    [stringTableCellTemplate]="_stringTableCell ? stringTableCell : undefined"
    [numberTableCellTemplate]="_numberTableCell ? numberTableCell : undefined"
    [tableDateCellTemplate]="_tableDateCell ? tableDateCell : undefined"
    [tableRelativeDateTemplate]="_tableRelativeDateCell ? tableRelativeDateCell : undefined"
    [tableCellTemplate]="_tableCell ? tableCell : undefined"
    [tableTranslationKeyCellTemplate]="_tableTranslationKeyCell ? tableTranslationKeyCell : undefined"
    [gridItemSubtitleLinesTemplate]="_gridItemSubtitleLines ? gridItemSubtitleLines : undefined"
    [listItemSubtitleLinesTemplate]="_listItemSubtitleLines ? listItemSubtitleLines : undefined"
    [listItemTemplate]="_listItem? listItem : undefined"
    [gridItemTemplate]="_gridItem? gridItem  : undefined"
    (sorted)="sorting($event)"
    (filtered)="filtering($event)"
  >
  </ocx-data-view>
</div>
<ng-template #stringTableCell let-rowObject="rowObject" let-column="column">
  <ng-container
    *ngIf="_stringTableCell"
    [ngTemplateOutlet]="_stringTableCell"
    [ngTemplateOutletContext]="{rowObject: rowObject, column:column}"
  >
  </ng-container
></ng-template>
<ng-template #tableDateCell let-rowObject="rowObject" let-column="column">
  <ng-container
    *ngIf="_tableDateCell"
    [ngTemplateOutlet]="_tableDateCell"
    [ngTemplateOutletContext]="{rowObject:rowObject, column:column}"
  >
  </ng-container
></ng-template>
<ng-template #tableRelativeDateCell let-rowObject="rowObject" let-column="column">
  <ng-container
    *ngIf="_tableRelativeDateCell"
    [ngTemplateOutlet]="_tableRelativeDateCell"
    [ngTemplateOutletContext]="{rowObject:rowObject, column:column}"
  >
  </ng-container
></ng-template>
<ng-template #tableCell let-rowObject="rowObject" let-column="column">
  <ng-container
    *ngIf="_tableCell"
    [ngTemplateOutlet]="_tableCell"
    [ngTemplateOutletContext]="{rowObject: rowObject, column:column}"
  >
  </ng-container
></ng-template>
<ng-template #tableTranslationKeyCell let-rowObject="rowObject" let-column="column">
  <ng-container
    *ngIf="_tableTranslationKeyCell"
    [ngTemplateOutlet]="_tableTranslationKeyCell"
    [ngTemplateOutletContext]="{rowObject:rowObject, column:column}"
  >
  </ng-container
></ng-template>
<ng-template #gridItemSubtitleLines let-item>
  <ng-container
    *ngIf="_gridItemSubtitleLines"
    [ngTemplateOutlet]="_gridItemSubtitleLines"
    [ngTemplateOutletContext]="{$implicit:item}"
  >
  </ng-container>
</ng-template>
<ng-template #listItemSubtitleLines let-item>
  <ng-container
    *ngIf="_listItemSubtitleLines"
    [ngTemplateOutlet]="_listItemSubtitleLines"
    [ngTemplateOutletContext]="{$implicit:item}"
  >
  </ng-container
></ng-template>
<ng-template #gridItem let-item>
  <ng-container *ngIf="_gridItem" [ngTemplateOutlet]="_gridItem" [ngTemplateOutletContext]="{$implicit:item}">
  </ng-container
></ng-template>
<ng-template #listItem let-item>
  <ng-container *ngIf="_listItem" [ngTemplateOutlet]="_listItem" [ngTemplateOutletContext]="{$implicit:item}">
  </ng-container
></ng-template>
